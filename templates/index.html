<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notre Dame Football</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v={{ cache_buster }}">
</head>
<body>
  <header class="banner">
    <div class="banner-left">
      <img class="team-logo" src="{{ url_for('static', filename='nd-logo.png') }}?v={{ cache_buster }}" alt="ND">
      <div class="team-title">
        <h1>Notre Dame Football</h1>
        <p class="updated">Updated: {{ updated }}</p>
      </div>
    </div>
    <button id="fightBtn" class="fight-button" type="button">Victory March</button>
    <audio id="fightAudio" preload="none" src="{{ url_for('static', filename='victory-march.mp3') }}"></audio>
  </header>

  <main>
    <section class="filters">
      <form method="get" id="filterForm">
        <label for="sourceSelect">News sources:</label>
        <select id="sourceSelect" name="source" onchange="this.form.submit()">
          <option value="all" {{ 'selected' if selected_source=='all' else '' }}>All sources</option>
          {% for s in sources %}
            <option value="{{ s }}" {{ 'selected' if selected_source==s else '' }}>{{ s }}</option>
          {% endfor %}
        </select>
      </form>
    </section>

    <section id="articles">
      {% for item in items %}
      <article class="article" data-source="{{ item.source }}">
        <a class="article-title" href="{{ item.link }}" target="_blank" rel="noopener">
          {{ item.title }}
        </a>
        {% if item.summary %}
          <p class="article-summary">{{ item.summary }}</p>
        {% endif %}
        <p class="article-meta">{{ item.source }} â€¢ {{ item.published }}</p>
      </article>
      {% endfor %}
      {% if not items %}
        <p class="empty">No articles for this source yet.</p>
      {% endif %}
    </section>
  </main>

  <script>
    // tiny, self-contained fight-song toggle (no external JS)
    (function() {
      var btn = document.getElementById('fightBtn');
      var audio = document.getElementById('fightAudio');
      if (!btn || !audio) return;
      btn.addEventListener('click', function () {
        if (audio.paused) { audio.play(); btn.classList.add('playing'); }
        else { audio.pause(); btn.classList.remove('playing'); }
      });
      audio.addEventListener('ended', function() { btn.classList.remove('playing'); });
    })();
  </script>
</body>
</html>