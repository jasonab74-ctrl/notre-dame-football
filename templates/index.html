<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notre Dame Football — News & Feeds</title>

  <!-- Cache-bust the CSS: update v= number if you ever need to force refresh -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=24" />

  <!-- System fonts for speed and consistency -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body class="page">

  <!-- ===== Banner ===== -->
  <header class="banner">
    <div class="brand">
      <img class="brand-mark" src="{{ url_for('static', filename='nd-logo.svg') }}" alt="ND" />
      <div class="brand-text">
        <h1 class="brand-title">Notre Dame<br/>Football</h1>
        <div class="updated">Updated: {{ updated_at }}</div>
      </div>
    </div>

    <button id="fightSongBtn" class="pill pill--cta" aria-pressed="false">Victory March</button>
    <!-- Audio stays invisible; JS only toggles play/pause, no layout jump -->
    <audio id="fightSongAudio" preload="none" src="{{ url_for('static', filename='victory-march.mp3') }}"></audio>
  </header>

  <!-- ===== Quick Links ===== -->
  <nav class="links">
    <a class="pill" href="https://fightingirish.com/">Official Site</a>
    <a class="pill" href="https://www.espn.com/college-football/team/schedule/_/id/87">Schedule</a>
    <a class="pill" href="https://www.espn.com/college-football/team/roster/_/id/87">Roster</a>
    <a class="pill" href="https://www.ncaa.com/rankings/football/fbs/associated-press">CFB Rankings</a>
    <a class="pill" href="https://www.ndinsider.com/">ND Insider</a>
    <a class="pill" href="https://www.reddit.com/r/notredamefootball/">Reddit — r/notredamefootball</a>
    <a class="pill" href="https://www.youtube.com/channel/UCAMR05qSc5mfhVx20fDyAoQ">YouTube — ND Football</a>
    <a class="pill" href="https://247sports.com/college/notre-dame/">247Sports ND</a>
    <a class="pill" href="https://www.espn.com/college-football/team/_/id/87/notre-dame-fighting-irish">ESPN ND Football</a>
    <a class="pill" href="https://www.cbssports.com/college-football/teams/ND/notre-dame-fighting-irish/">CBS Sports ND</a>
    <a class="pill" href="https://www.on3.com/teams/notre-dame-fighting-irish/">On3 — Blue & Gold</a>
    <a class="pill" href="https://theathletic.com/team/notre-dame-fighting-irish-football/">The Athletic — ND</a>
    <a class="pill" href="https://fightingirishwire.usatoday.com/">Fighting Irish Wire</a>
  </nav>

  <!-- ===== Filters / Controls ===== -->
  <section class="controls">
    <label class="control-label" for="sourcesSelect">News sources:</label>
    <select id="sourcesSelect" class="select" name="source" onchange="window.location.href='/?source='+encodeURIComponent(this.value)">
      <option value="">All sources</option>
      {% for s in sources %}
        <option value="{{ s.value }}" {% if s.selected %}selected{% endif %}>{{ s.label }}</option>
      {% endfor %}
    </select>

    {% if new_items_count and new_items_count > 0 %}
      <a class="pill pill--ghost" href="/refresh">refresh</a>
    {% else %}
      <button class="pill pill--ghost" disabled>refresh</button>
    {% endif %}
  </section>

  <!-- ===== Articles ===== -->
  <main class="cards" id="cards">
    {% for it in items %}
      <article class="card">
        <h2 class="card-title">
          <a href="{{ it.url }}" target="_blank" rel="noopener">{{ it.title }}</a>
        </h2>

        {% if it.summary %}
          <p class="card-summary">{{ it.summary }}</p>
        {% endif %}

        <div class="card-meta">
          <span class="meta-chip">{{ it.source }}</span>
          <span aria-hidden="true">•</span>
          <time datetime="{{ it.published_iso }}">{{ it.published_human }}</time>
        </div>
      </article>
    {% endfor %}
  </main>

  <footer class="footer">
    <span>{{ request.host }}</span>
  </footer>

  <script>
    // Fight Song: toggle play/pause without changing layout
    (function () {
      const btn = document.getElementById('fightSongBtn');
      const audio = document.getElementById('fightSongAudio');
      if (!btn || !audio) return;

      btn.addEventListener('click', () => {
        if (audio.paused) {
          audio.play().then(() => btn.setAttribute('aria-pressed', 'true'))
                       .catch(() => {}); // ignore autoplay blocks
        } else {
          audio.pause();
          btn.setAttribute('aria-pressed', 'false');
        }
      });
      audio.addEventListener('ended', () => btn.setAttribute('aria-pressed', 'false'));
    }());
  </script>
</body>
</html>